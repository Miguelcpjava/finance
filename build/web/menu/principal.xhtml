<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core">
    <h:head>
        <h:outputStylesheet library="css" name="/static/css/bootstrap.css"  />
        <h:outputScript name="./static/js/bootstrap.js"/>
        <h:outputScript name="./static/js/bootstrap.min.js"/>
        
        <title>Bem vindo ao #{sistema.NOMESISTEMA} #{sistema.VERSION}</title>
        <!--<script language="JavaScript" src="global.js"></script> -->
         <style type="text/css">
            .link:hover{
                background-color:  #CE8B3A;
                
            }
            .a{
                text-decoration: none;
            }
        </style>
        <script>
            function mascara(o, f) {
              v_obj = o;
              v_fun = f;
              setTimeout("execmascara()", 1);
            }

            function execmascara() {
              v_obj.value = v_fun(v_obj.value);
            }

         function valor(v) {
        v = v.replace(/\D/g, "");
        v = v.replace(/[0-9]{15}/, "invÃ¡lido");
        v = v.replace(/(\d{1})(\d{11})$/, "$1.$2"); // coloca ponto antes dos
        // Ãºltimos 11 digitos
        v = v.replace(/(\d{1})(\d{8})$/, "$1.$2"); // coloca ponto antes dos
        // Ãºltimos 8 digitos
        v = v.replace(/(\d{1})(\d{5})$/, "$1.$2"); // coloca ponto antes dos
        // Ãºltimos 5 digitos
        v = v.replace(/(\d{1})(\d{1,2})$/, "$1.$2"); // coloca virgula antes dos
        // Ãºltimos 2 digitos
        return v;
}

                    </script>
    </h:head>
    <h:body style="background-color: #CE8B3A">
        <h:form id="formmain">
            <p:menubar id="menuprincipal">
                <p:submenu label="Cadastro">
                    <p:menuitem value="Divida" outcome="/cadastro/divida.jsf">
                    </p:menuitem>
                   
                     <p:menuitem value="Usuário" outcome="/cadastro/usuario.jsf" >   
                    </p:menuitem>
                    <p:menuitem value="Pagamento" outcome="/cadastro/pagamento.jsf"></p:menuitem>
                     <p:separator/>
                     <p:menuitem value="LogOff" outcome="/index.jsf"/>
                </p:submenu>
                <p:submenu label="Administração">
                    <p:submenu label="Panel de Controle">
                        <p:menuitem value="Usuário" outcome="/admin/panelusuario.jsf"/>
                         <p:menuitem value="Dívidas" outcome="/admin/paneldivida.jsf"/>
                    </p:submenu>
                </p:submenu>
                <p:submenu label="Relatórios">
                    <p:menuitem value="Modelos" onclick="relatorio.show()"/>
                </p:submenu>
                <p:submenu label="Ajuda">
                    <p:menuitem value="Sobre" outcome="/sobre.jsf"/>
                </p:submenu>
            </p:menubar>
            
            <p:messages autoUpdate="true" closable="true"  id="avisos"/>
            <p:dataTable id="paneluser" value="#{dividaFaces.listofDivida}" var="divida" selection="#{dividaFaces.selectedDivida}"
                         emptyMessage="Não existe Dívida" paginator="true" rows="10" rowKey="#{divida.id}" selectionMode="single">
                <f:facet name="header">
                    Panel de Dívidas Cadastradas
                </f:facet>
                <p:ajax oncomplete="pagetela.show()" update=":formmain:telapagamento" event="rowSelect"/>
                <p:column headerText="ID">
                    #{divida.id}
                </p:column>
                <p:column headerText="Empresa">
                    #{divida.empresa}
                </p:column>
                <p:column headerText="Vencimento" sortBy="#{divida.vencimento}">
                    <h:outputText value="#{divida.vencimento}">
                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                    </h:outputText>
                </p:column>
                <p:column headerText="Tipo">
                    #{divida.tipolancamento}
                </p:column>
                <p:column headerText="Descricão">
                    #{divida.descricao}
                </p:column>
                <f:facet name="footer">
                    Financé v#{sistema.VERSION}
                </f:facet>
            </p:dataTable>
            <p:dialog id="telapagamento" widgetVar="pagetela" header="Panel do Cadastro da Divida">
                <p:panelGrid columns="2">
                      <p:outputLabel for="tipolanc" value="Tipo Lançamento: "/>
            <p:selectOneMenu id="tipolanc" value="#{dividaFaces.selectedDivida.tipolancamento}">
                <f:selectItem itemLabel="|| - Selecione - || "/>
                <f:selectItem itemLabel="Receita" itemValue="R"/>
                <f:selectItem itemLabel="Despesa" itemValue="D"/>
            </p:selectOneMenu>
                      <p:outputLabel for="parcelas" value="Parcelas: "/>
                       <p:spinner id="parcelas" value="#{dividaFaces.selectedDivida.parcelas}" size="4" title="0 é igual a compra a vista!"/>
                       <p:outputLabel for="valortotal" value="Valor: "/>
            <p:inputText id="valortotal" required="true" value="#{dividaFaces.selectedDivida.valortotal}">
                       <f:convertNumber pattern="#,##0.00" minFractionDigits="2"  />  
            </p:inputText>
                      <p:outputLabel for="pago" value="Pago? "/>
                      <h:outputText id="pago" value="#{dividaFaces.statuspagamento}"/>
                </p:panelGrid>

            </p:dialog>
            
            <p:dialog id="impressRel" widgetVar="relatorio" header="Relatórios" closable="true" showEffect="fade">
                <p:panelGrid columns="2">
                <p:outputLabel for="choiserel" value="Modelo de Relatório: "/>
                <p:selectOneMenu id="choiserel" value="#{dividaFaces.nomeRelatorio}">
                 <f:selectItem itemLabel="|| - Selecione - || "/>
                 <f:selectItem itemLabel="Contas a Pagar" itemValue="contasapagar"/>
                 <f:selectItem itemLabel="Contas Pagas" itemValue="contaspagas"/>
                 <f:selectItem itemLabel="Contas que falta pagar" itemValue="contasquefaltapagar"/>
                 <p:ajax update=":formmain:testerel"/>
                </p:selectOneMenu>
                <p:outputLabel for="mesdorel" value="Mês desejado: "/>
                <p:spinner  id="mesdorel" value="#{dividaFaces.mesdesejado}" max="12" min="1" size="4">
                    <p:ajax update=":formmain:teste"/>
                </p:spinner>
                
                <h:outputText id="teste" value="#{dividaFaces.mesdesejado}"/>
                <h:outputText id="testerel" value="#{dividaFaces.nomeRelatorio}"/>
                <f:facet name="footer">
                    <center>
                        <h:commandLink id="gerarel" styleClass="a" value="Gerar!" action="#{dividaFaces.printReport}" immediate="true" target="_blank"/>
                    </center>
                </f:facet>
                </p:panelGrid>
                
                
            </p:dialog>
        </h:form>
        
    </h:body>
</html>

